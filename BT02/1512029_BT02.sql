/**********************************************************************************************************************/
/* Tạo cơ sở dữ liệu Quản lý đề tài */
GO
CREATE DATABASE QuanLyDeTai
GO
USE QuanLyDeTai
GO

/* Tạo bảng GIAOVIEN */
CREATE TABLE GIAOVIEN (
	[MAGV] [varchar](3) NOT NULL,
	[HOTEN] [nvarchar](30) NULL,
	[LUONG] [decimal](18, 1) NULL,
	[PHAI] [nchar](3) NULL,
	[NGSINH] [date] NULL,
	[DIACHI] [nvarchar](50) NULL,
	[GVQLCM] [varchar](3) NULL,
	[MABM] [nchar](4) NULL,
	PRIMARY KEY (MAGV)
)

ALTER TABLE GIAOVIEN
ADD CONSTRAINT C_PHAI
CHECK (PHAI IN('Nam', N'Nữ'))

/* Tạo bảng GV_DT */
CREATE TABLE GV_DT (
	[MAGV] [varchar](3) NOT NULL,
	[DIENTHOAI] [varchar](12) NOT NULL,
	PRIMARY KEY (MAGV, DIENTHOAI)
)

/* Tạo bảng NGUOITHAN */
CREATE TABLE NGUOITHAN (
	[MAGV] [varchar](3) NOT NULL,
	[TEN] [nvarchar](20) NOT NULL,
	[NGSINH] [date] NULL,
	[PHAI] [nchar](3) NULL,
	PRIMARY KEY (MAGV, TEN)
)

ALTER TABLE NGUOITHAN
ADD CONSTRAINT K_PHAI
CHECK (PHAI IN('Nam', N'Nữ'))

/* Tạo bảng BOMON */
CREATE TABLE BOMON (
	[MABM] [nchar](4) NOT NULL,
	[TENBM] [nvarchar](50) NULL,
	[PHONG] [char](3) NULL,
	[DIENTHOAI] [varchar](12) NULL,
	[TRUONGBM] [varchar](3) NULL,
	[MAKHOA] [nvarchar](4) NULL,
	[NGAYNHANCHUC] [date] NULL,
	PRIMARY KEY (MABM)
)

/* Tạo bảng KHOA */
CREATE TABLE KHOA (
	[MAKHOA] [nvarchar](4) NOT NULL,
	[TENKHOA] [nvarchar](30) NULL,
	[NAMTL] [int] NULL,
	[PHONG] [char](3) NULL,
	[DIENTHOAI] [varchar](12) NULL,
	[TRUONGKHOA] [varchar](3) NULL,
	[NGAYNHANCHUC] [date] NULL,
	PRIMARY KEY (MAKHOA)
)

/* Tạo bảng CHUDE */
CREATE TABLE CHUDE (
	[MACD] [nchar](4) NOT NULL,
	[TENCD] [nvarchar](50) NULL,
	PRIMARY KEY (MACD)
)
	
/* Tạo bảng DETAI */
CREATE TABLE DETAI (
	[MADT] [varchar](3) NOT NULL,
	[TENDT] [nvarchar](50) NULL,
	[CAPQL] [nvarchar](20) NULL,
	[KINHPHI] [decimal](18, 1) NULL,
	[NGAYBD] [date] NULL,
	[NGAYKT] [date] NULL,
	[MACD] [nchar](4) NULL,
	[GVCNDT] [varchar](3) NULL,
	PRIMARY KEY (MADT)
)

/* Tạo bảng CONGVIEC */
CREATE TABLE CONGVIEC (
	[MADT] [varchar](3) NOT NULL,
	[SOTT] [int] NOT NULL,
	[TENCV] [nvarchar](50) NULL,
	[NGAYBD] [date] NULL,
	[NGAYKT] [date] NULL,
	PRIMARY KEY (MADT, SOTT)
)

/* Tạo bảng THAMGIADT */
CREATE TABLE THAMGIADT (
	[MAGV] [varchar](3) NOT NULL,
	[MADT] [varchar](3) NOT NULL,
	[STT] [int] NOT NULL,
	[PHUCAP] [decimal](18, 1) NULL,
	[KETQUA] [nvarchar](3) NULL,
	PRIMARY KEY (MAGV, MADT, STT)
)

/***********************************************************/
/****** Tạo các khóa ngoại ******/

/* Tạo khóa ngoại NGUOITHAN_GIAOVIEN */
ALTER TABLE NGUOITHAN 
ADD CONSTRAINT FK_NGUOITHAN_GIAOVIEN
FOREIGN KEY (MAGV)
REFERENCES GIAOVIEN(MAGV)

/* Tạo khóa ngoại GV_DT_GIAOVIEN */
ALTER TABLE GV_DT
ADD CONSTRAINT FK_GV_DT_GIAOVIEN
FOREIGN KEY (MAGV)
REFERENCES GIAOVIEN(MAGV)

/* Tạo khóa ngoại THAMGIADT_GIAOVIEN */
ALTER TABLE THAMGIADT
ADD CONSTRAINT FK_THAMGIADT_GIAOVIEN
FOREIGN KEY (MAGV)
REFERENCES GIAOVIEN(MAGV)

/* Tạo khóa ngoại DETAI_GIAOVIEN */
ALTER TABLE DETAI
ADD CONSTRAINT FK_DETAI_GIAOVIEN
FOREIGN KEY (GVCNDT)
REFERENCES GIAOVIEN(MAGV)

/* Tạo khóa ngoại THAMGIADT_CONGVIEC */
ALTER TABLE THAMGIADT
ADD CONSTRAINT FK_THAMGIADT_CONGVIEC
FOREIGN KEY (MADT, STT)
REFERENCES CONGVIEC(MADT, SOTT)

/* Tạo khóa ngoại CONGVIEC_DETAI */
ALTER TABLE CONGVIEC
ADD CONSTRAINT FK_CONGVIEC_DETAI
FOREIGN KEY (MADT)
REFERENCES DETAI(MADT)

/* Tạo khóa ngoại DETAI_CHUDE */
ALTER TABLE DETAI
ADD CONSTRAINT FK_DETAI_CHUDE
FOREIGN KEY (MACD)
REFERENCES CHUDE(MACD)

/* Tạo khóa ngoại BOMON_KHOA */
ALTER TABLE BOMON
ADD CONSTRAINT FK_BOMON_KHOA
FOREIGN KEY (MAKHOA)
REFERENCES KHOA(MAKHOA)

/* Tạo khóa ngoại KHOA_GIAOVIEN */
ALTER TABLE KHOA
ADD CONSTRAINT FK_KHOA_GIAOVIEN
FOREIGN KEY (TRUONGKHOA)
REFERENCES GIAOVIEN(MAGV)

/* Tạo khóa ngoại BOMON_GIAOVIEN */
ALTER TABLE BOMON
ADD CONSTRAINT FK_BOMON_GIAOVIEN
FOREIGN KEY (TRUONGBM)
REFERENCES GIAOVIEN(MAGV)

/* Tạo khóa ngoại GIAOVIEN_BOMON */
ALTER TABLE GIAOVIEN
ADD CONSTRAINT FK_GIAOVIEN_BOMON
FOREIGN KEY (MABM)
REFERENCES BOMON(MABM)

/* Tạo khóa ngoại GIAOVIEN_GIAOVIEN */
ALTER TABLE GIAOVIEN
ADD CONSTRAINT FK_GIAOVIEN_GIAOVIEN
FOREIGN KEY (GVQLCM)
REFERENCES GIAOVIEN(MAGV)


/***********************************************************/
/******* INSERT DATA TO QuanLyDeTai *******/
GO
/* Insert dữ liệu vào bảng CHHUDE */
INSERT CHUDE (MACD, TENCD) VALUES (N'NCPT', N'Nghiên cứu phát triển')
INSERT CHUDE (MACD, TENCD) VALUES (N'QLGD', N'Quản lý giáo dục')
INSERT CHUDE (MACD, TENCD) VALUES (N'ƯDCN', N'Ứng dụng công nghệ')

/* Insert dữ liệu vào bảng KHOA */
INSERT KHOA (MAKHOA, TENKHOA, NAMTL, PHONG, DIENTHOAI, TRUONGKHOA, NGAYNHANCHUC) VALUES (N'CNTT', N'Công nghệ thông tin', 1995, 'B11', '0838123456', NULL, NULL)
INSERT KHOA (MAKHOA, TENKHOA, NAMTL, PHONG, DIENTHOAI, TRUONGKHOA, NGAYNHANCHUC) VALUES (N'HH', N'Hóa học', 1980, 'B41', '0838456456', NULL, NULL)
INSERT KHOA (MAKHOA, TENKHOA, NAMTL, PHONG, DIENTHOAI, TRUONGKHOA, NGAYNHANCHUC) VALUES (N'SH', N'Sinh học', 1980, 'B31', '0838454545', NULL, NULL)
INSERT KHOA (MAKHOA, TENKHOA, NAMTL, PHONG, DIENTHOAI, TRUONGKHOA, NGAYNHANCHUC) VALUES (N'VL', N'Vật lý', 1976, 'B21', '0838223223', NULL, NULL)

/* Insert dữ liệu vào bảng BOMON */
INSERT BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC) VALUES (N'CNTT', N'Công nghệ tri thức', 'B15', '0838126126', NULL, N'CNTT', NULL)
INSERT BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC) VALUES (N'HHC ', N'Hóa hữu cơ', 'B44', '838222222', NULL, N'HH', NULL)
INSERT BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC) VALUES (N'HL  ', N'Hóa lý', 'B42', '0838878787', NULL, N'HH', NULL)
INSERT BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC) VALUES (N'HPT ', N'Hóa phân tích', 'B43', '0838777777', NULL, N'HH', NULL)
INSERT BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC) VALUES (N'HTTT', N'Hệ thống thông tin', 'B13', '0838125125', NULL, N'CNTT', NULL)
INSERT BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC) VALUES (N'MMT ', N'Mạng máy tính', 'B16', '0838676767', NULL, N'CNTT', NULL)
INSERT BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC) VALUES (N'SH  ', N'Sinh hóa', 'B33', '0838898989', NULL, N'SH', NULL)
INSERT BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC) VALUES (N'VLĐT', N'Vật lý điện tử', 'B23', '0838234234', NULL, N'VL', NULL)
INSERT BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC) VALUES (N'VLƯD', N'Vật lý ứng dụng', 'B24', '0838454545', NULL, N'VL', NULL)
INSERT BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC) VALUES (N'VS  ', N'Vi sinh', 'B32', '0838909090', NULL, N'SH', NULL)

/* Insert dữ liệu vào bảng GIAOVIEN */
INSERT GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM) VALUES ('001', N'Nguyễn Hoài An', 2000.0, 'Nam', '02/15/1973', N'25/3 Lạc Long Quân, Q.10, TP HCM', NULL, N'MMT ')
INSERT GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM) VALUES ('002', N'Trần Trà Hương', 2500.0, N'Nữ ', '06/20/1960', N'125 Trần Hưng Đạo, Q.1, TP HCM', NULL, N'HTTT')
INSERT GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM) VALUES ('003', N'Nguyễn Ngọc Ánh', 2200.0, N'Nữ ', '05/11/1975', N'12/21 Võ Văn Ngân, Thủ Đức, TP HCM', '002', N'HTTT')
INSERT GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM) VALUES ('004', N'Trương Nam Sơn', 2300.0, 'Nam', '06/20/1959', N'215 Lý Thường Kiệt, TP Biên Hòa', NULL, N'VS  ')
INSERT GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM) VALUES ('005', N'Lý Hoàng Hà', 2500.0, 'Nam', '10/23/1954', N'22/5 Nguyễn Xí, Q.Bình Thạnh, TP HCM', NULL, N'VLĐT')
INSERT GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM) VALUES ('006', N'Trần Bạch Tuyết', 1500.0, N'Nữ ', '05/20/1980', N'127 Hùng Vương, TP Mỹ Tho', '004', N'VS  ')
INSERT GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM) VALUES ('007', N'Nguyễn An Trung', 2100.0, 'Nam', '06/05/1976', N'234 3/2, TP Biên Hòa', NULL, N'HPT ')
INSERT GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM) VALUES ('008', N'Trần Trung Hiếu', 1800.0, 'Nam', '08/06/1977', N'22/11 Lý Thường Kiệt, TP Mỹ Tho', '007', N'HPT ')
INSERT GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM) VALUES ('009', N'Trần Hoàng Nam', 2000.0, 'Nam', '11/22/1975', N'234 Trần Não, An Phú, TP HCM', '001', N'MMT ')
INSERT GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM) VALUES ('010', N'Phạm Nam Thanh', 1500.0, 'Nam', '12/12/1980', N'221 Hùng Vương, Q.5, TP HCM', '007', N'HPT ')

/* Set TRUONGKHOA cho bảng KHOA */
/* CNTT */
UPDATE KHOA
SET TRUONGKHOA = '002', NGAYNHANCHUC = '02/20/2005'
WHERE MAKHOA = N'CNTT'
/* HH */
UPDATE KHOA
SET TRUONGKHOA = '007', NGAYNHANCHUC = '10/15/2001'
WHERE MAKHOA = N'HH'
/* SH */
UPDATE KHOA
SET TRUONGKHOA = '004', NGAYNHANCHUC = '10/11/2000'
WHERE MAKHOA = N'SH'
/* VL */
UPDATE KHOA
SET TRUONGKHOA = '005', NGAYNHANCHUC = '09/18/2003'
WHERE MAKHOA = N'VL'

/* Set TRUONGBM cho bảng BOMON */
/* HPT */
UPDATE BOMON
SET TRUONGBM = '007', NGAYNHANCHUC = '10/15/2007'
WHERE MABM = N'HPT'
/* HTTT */
UPDATE BOMON
SET TRUONGBM = '002', NGAYNHANCHUC = '09/20/2004'
WHERE MABM = N'HTTT'
/* MMT */
UPDATE BOMON
SET TRUONGBM = '001', NGAYNHANCHUC = '05/15/2005'
WHERE MABM = N'MMT'
/* VLƯD */
UPDATE BOMON
SET TRUONGBM = '005', NGAYNHANCHUC = '02/18/2006'
WHERE MABM = N'VLƯD'
/* VS */
UPDATE BOMON
SET TRUONGBM = '004', NGAYNHANCHUC = '01/01/2007'
WHERE MABM = N'VS'

/* Insert dữ liệu vào bảng NGUOITHAN */
INSERT NGUOITHAN (MAGV, TEN, NGSINH, PHAI) VALUES ('001', N'Hùng', '01/14/1990', 'Nam')
INSERT NGUOITHAN (MAGV, TEN, NGSINH, PHAI) VALUES ('001', N'Thủy', '12/08/1994', N'Nữ ')
INSERT NGUOITHAN (MAGV, TEN, NGSINH, PHAI) VALUES ('003', N'Hà', '09/03/1998', N'Nữ ')
INSERT NGUOITHAN (MAGV, TEN, NGSINH, PHAI) VALUES ('003', N'Thu', '09/03/1998', N'Nữ ')
INSERT NGUOITHAN (MAGV, TEN, NGSINH, PHAI) VALUES ('007', N'Mai', '03/26/2003', N'Nữ ')
INSERT NGUOITHAN (MAGV, TEN, NGSINH, PHAI) VALUES ('007', N'Vy', '02/14/2000', N'Nữ ')
INSERT NGUOITHAN (MAGV, TEN, NGSINH, PHAI) VALUES ('008', N'Nam', '05/06/1991', 'Nam')
INSERT NGUOITHAN (MAGV, TEN, NGSINH, PHAI) VALUES ('009', N'An', '08/19/1996', 'Nam')
INSERT NGUOITHAN (MAGV, TEN, NGSINH, PHAI) VALUES ('010', N'Nguyệt', '01/14/2006', N'Nữ ')

/* Insert dữ liệu vào bảng DIENTHOAI */
INSERT GV_DT (MAGV, DIENTHOAI) VALUES ('001', '0838912112')
INSERT GV_DT (MAGV, DIENTHOAI) VALUES ('001', '0903123123')
INSERT GV_DT (MAGV, DIENTHOAI) VALUES ('002', '0913454545')
INSERT GV_DT (MAGV, DIENTHOAI) VALUES ('003', '0838121212')
INSERT GV_DT (MAGV, DIENTHOAI) VALUES ('003', '0903656565')
INSERT GV_DT (MAGV, DIENTHOAI) VALUES ('003', '0937125125')
INSERT GV_DT (MAGV, DIENTHOAI) VALUES ('006', '0937888888')
INSERT GV_DT (MAGV, DIENTHOAI) VALUES ('008', '0653717171')
INSERT GV_DT (MAGV, DIENTHOAI) VALUES ('008', '0913232323')

/* Insert dữ liệu vào bảng DETAI */
INSERT DETAI (MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT) VALUES ('001', N'HTTT quản lý các trường ĐH', N'ĐHQG', 20.0, '10/20/2007', '10/20/2008', N'QLGD', '002')
INSERT DETAI (MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT) VALUES ('002', N'HTTT quản lý giáo vụ cho một Khoa', N'Trường', 20.0, '10/12/2000', '10/12/2001', N'QLGD', '002')
INSERT DETAI (MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT) VALUES ('003', N'Nghiên cứu chế tạo sợi Nanô Platin', N'ĐHQG', 300.0, '05/15/2008', '05/15/2010', N'NCPT', '005')
INSERT DETAI (MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT) VALUES ('004', N'Tạo vật liệu sinh học bằng màng ối người', N'Nhà nước', 100.0, '01/01/2007', '12/31/2009', N'NCPT', '004')
INSERT DETAI (MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT) VALUES ('005', N'Ứng dụng hóa học xanh', N'Trường', 200.0, '10/10/2003', '12/10/2004', N'ƯDCN', '007')
INSERT DETAI (MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT) VALUES ('006', N'Nghiên cứu tế bào gốc', N'Nhà nước', 4000.0, '10/20/2006', '10/20/2009', N'NCPT', '004')
INSERT DETAI (MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT) VALUES ('007', N'HTTT quản lý thư viện ở các trường ĐH', N'Trường', 20.0, '05/10/2009', '05/10/2010',N'QLGD', '001')

/* Insert dữ liệu vào bảng CONGVIEC */
INSERT CONGVIEC (MADT, SOTT, TENCV, NGAYBD, NGAYKT) VALUES ('001', 1, N'Khởi tạo và Lập kế hoạch', '10/20/2007', '12/20/2008')
INSERT CONGVIEC (MADT, SOTT, TENCV, NGAYBD, NGAYKT) VALUES ('001', 2, N'Xác định yêu cầu', '12/21/2008', '03/21/2008')
INSERT CONGVIEC (MADT, SOTT, TENCV, NGAYBD, NGAYKT) VALUES ('001', 3, N'Phân tích hệ thống', '03/22/2008', '05/22/2008')
INSERT CONGVIEC (MADT, SOTT, TENCV, NGAYBD, NGAYKT) VALUES ('001', 4, N'Thiết kế hệ thống', '05/23/2008', '06/23/2008')
INSERT CONGVIEC (MADT, SOTT, TENCV, NGAYBD, NGAYKT) VALUES ('001', 5, N'Cài đặt thử nghiệm', '06/24/2008', '10/20/2008')
INSERT CONGVIEC (MADT, SOTT, TENCV, NGAYBD, NGAYKT) VALUES ('002', 1, N'Khởi tạo và Lập kế hoạch', '05/10/2009', '07/10/2009')
INSERT CONGVIEC (MADT, SOTT, TENCV, NGAYBD, NGAYKT) VALUES ('002', 2, N'Xác định yêu cầu', '07/11/2009', '10/11/2009')
INSERT CONGVIEC (MADT, SOTT, TENCV, NGAYBD, NGAYKT) VALUES ('002', 3, N'Phân tích hệ thống', '10/12/2009', '12/20/2009')
INSERT CONGVIEC (MADT, SOTT, TENCV, NGAYBD, NGAYKT) VALUES ('002', 4, N'Thiết kế hệ thống', '12/21/2009', '03/22/2010')
INSERT CONGVIEC (MADT, SOTT, TENCV, NGAYBD, NGAYKT) VALUES ('002', 5, N'Cài đặt thử nghiệm', '03/23/2010', '05/10/2010')
INSERT CONGVIEC (MADT, SOTT, TENCV, NGAYBD, NGAYKT) VALUES ('006', 1, N'Lấy mẫu', '10/20/2006', '02/20/2007')
INSERT CONGVIEC (MADT, SOTT, TENCV, NGAYBD, NGAYKT) VALUES ('006', 2, N'Nuôi cấy', '02/21/2007', '08/21/2008')

/* Insert dữ liệu vào bảng THAMGIADT */
INSERT THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA) VALUES ('001', '002', 1, 0.0, NULL)
INSERT THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA) VALUES ('001', '002', 2, 2.0, NULL)
INSERT THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA) VALUES ('002', '001', 4, 2.0, N'Đạt')
INSERT THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA) VALUES ('003', '001', 1, 1.0, N'Đạt')
INSERT THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA) VALUES ('003', '001', 2, 0.0, N'Đạt')
INSERT THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA) VALUES ('003', '001', 4, 1.0, N'Đạt')
INSERT THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA) VALUES ('003', '002', 2, 0.0, NULL)
INSERT THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA) VALUES ('004', '006', 1, 0.0, N'Đạt')
INSERT THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA) VALUES ('004', '006', 2, 1.0, N'Đạt')
INSERT THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA) VALUES ('006', '006', 2, 1.5, N'Đạt')
INSERT THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA) VALUES ('009', '002', 3, 0.5, NULL)
INSERT THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA) VALUES ('009', '002', 4, 1.5, NULL)


/**********************************************************************************************************************/
/***********************************************************/
/* Tạo cơ sở dữ liệu Quản lý chuyến bay */
GO
CREATE DATABASE QuanLyChuyenBay
GO
USE QuanLyChuyenBay
GO

/* Tạo bảng CHUYENBAY */
CREATE TABLE CHUYENBAY (
	[MACB] [varchar](4) NOT NULL,
	[SBDI] [varchar](3) NULL,
	[SBDEN] [varchar](3) NULL,
	[GIODI] [time](6) NULL,
	[GIODEN] [time](6) NULL,
	PRIMARY KEY (MACB)
)

/* Tạo bảng KHACHHANG */
CREATE TABLE KHACHHANG (
	[MAKH] [varchar](15) NOT NULL,
	[TEN] [varchar](15) NULL,
	[DCHI] [varchar](50) NULL,
	[DTHOAI] [varchar](12) NULL,
	PRIMARY KEY (MAKH)
)

/* Tạo bảng LOAIMB */
CREATE TABLE LOAIMB (
	[HANGSX] [varchar](15) NULL,
	[MALOAI] [varchar](15) NOT NULL,
	PRIMARY KEY (MALOAI)
)

/* Tạo bảng NHANVIEN */
CREATE TABLE NHANVIEN (
	[MANV] [varchar](15) NOT NULL,
	[TEN] [varchar](15) NULL,
	[DCHI] [varchar](50) NULL,
	[DTHOAI] [varchar](12) NULL,
	[LUONG] [decimal](10, 2) NULL,
	[LOAINV] [bit] NULL,
	PRIMARY KEY (MANV)
)

ALTER TABLE NHANVIEN
ADD CONSTRAINT C_LOAINV
CHECK (LOAINV IN(0, 1))

/* Tạo bảng MAYBAY */
CREATE TABLE MAYBAY (
	[SOHIEU] [int] NOT NULL,
	[MALOAI] [varchar](15) NOT NULL,
	PRIMARY KEY (SOHIEU, MALOAI)
)

/* Tạo bảng KHANANG */
CREATE TABLE KHANANG (
	[MANV] [varchar](15) NOT NULL,
	[MALOAI] [varchar](15) NOT NULL,
	PRIMARY KEY (MANV, MALOAI)
)

/* Tạo bảng LICHBAY */
CREATE TABLE LICHBAY (
	[NGAYDI] [date] NOT NULL,
	[MACB] [varchar](4) NOT NULL,
	[SOHIEU] [int] NULL,
	[MALOAI] [varchar](15) NULL,
	PRIMARY KEY (NGAYDI, MACB)
)

/* Tạo bảng PHANCONG */
CREATE TABLE [dbo].[PHANCONG](
	[MANV] [varchar](15) NOT NULL,
	[NGAYDI] [date] NOT NULL,
	[MACB] [varchar](4) NOT NULL,
	PRIMARY KEY (MANV, NGAYDI, MACB)
)

/* Tạo bảng DATCHO */
CREATE TABLE [dbo].[DATCHO](
	[MAKH] [varchar](15) NOT NULL,
	[NGAYDI] [date] NOT NULL,
	[MACB] [varchar](4) NOT NULL,
	PRIMARY KEY (MAKH, NGAYDI, MACB)
)


/***********************************************************/
/****** Tạo các khóa ngoại ******/

/* Tạo khóa ngoại DATCHO_KHACHHANG */
ALTER TABLE DATCHO
ADD CONSTRAINT FK_DATCHO_KHACHHANG
FOREIGN KEY (MAKH)
REFERENCES KHACHHANG(MAKH)

/* Tạo khóa ngoại DATCHO_LICHBAY */
ALTER TABLE DATCHO
ADD CONSTRAINT FK_DATCHO_LICHBAY
FOREIGN KEY (NGAYDI, MACB)
REFERENCES LICHBAY(NGAYDI, MACB)

/* Tạo khóa ngoại LICHBAY_CHUYENBAY */
ALTER TABLE LICHBAY
ADD CONSTRAINT FK_LICHBAY_CHUYENBAY
FOREIGN KEY (MACB)
REFERENCES CHUYENBAY(MACB)

/* Tạo khóa ngoại MAYBAY_LOAIMB */
ALTER TABLE MAYBAY
ADD CONSTRAINT FK_MAYBAY_LOAIMB
FOREIGN KEY (MALOAI)
REFERENCES LOAIMB(MALOAI)

/* Tạo khóa ngoại KHANANG_LOAIMB */
ALTER TABLE KHANANG
ADD CONSTRAINT FK_KHANANG_LOAIMB
FOREIGN KEY (MALOAI)
REFERENCES LOAIMB(MALOAI)

/* Tạo khóa ngoại KHANANG_NHANVIEN */
ALTER TABLE KHANANG
ADD CONSTRAINT FK_KHANANG_NHANVIEN
FOREIGN KEY (MANV)
REFERENCES NHANVIEN(MANV)

/* Tạo khóa ngoại PHANCONG_NHANVIEN */
ALTER TABLE PHANCONG
ADD CONSTRAINT FK_PHANCONG_NHANVIEN
FOREIGN KEY (MANV)
REFERENCES NHANVIEN(MANV)

/* Tạo khóa ngoại PHANCONG_LICHBAY */
ALTER TABLE PHANCONG
ADD CONSTRAINT FK_PHANCONG_LICHBAY
FOREIGN KEY (NGAYDI, MACB)
REFERENCES LICHBAY(NGAYDI, MACB)

/* Tạo khóa ngoại LICHBAY_MAYBAY */
AlTER TABLE LICHBAY
ADD CONSTRAINT FK_LICHBAY_MAYBAY
FOREIGN KEY (SOHIEU, MALOAI)
REFERENCES MAYBAY(SOHIEU, MALOAI)

/***********************************************************/
/******* INSERT DATA TO QuanLyChuyenBay *******/
GO
/* Insert dữ liệu vào bảng CHUYENBAY */
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('100', 'SLC', 'BOS', '08:00', '17:50')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('112', 'DCA', 'DEN', '14:00', '18:07')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('121', 'STL', 'SLC', '07:00', '09:13')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('122', 'STL', 'YYV', '08:30', '10:19')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('206', 'DFW', 'STL', '09:00', '11:40')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('330', 'JFK', 'YYV', '16:00', '18:53')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('334', 'ORD', 'MIA', '12:00', '14:14')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('335', 'MIA', 'ORD', '15:00', '17:14')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('336', 'ORD', 'MIA', '18:00', '20:14')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('337', 'MIA', 'ORD', '20:30', '23:53')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('394', 'DFW', 'MIA', '19:00', '21:30')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('395', 'MIA', 'DFW', '21:00', '23:43')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('449', 'CDG', 'DEN', '10:00', '19:29')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('930', 'YYV', 'DCA', '13:00', '16:10')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('931', 'DCA', 'YYV', '17:00', '18:10')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('932', 'DCA', 'YYV', '18:00', '19:10')
INSERT CHUYENBAY (MACB, SBDI, SBDEN, GIODI, GIODEN) VALUES ('991', 'BOS', 'ORD', '17:00', '18:22')

/* Insert dữ liệu vào bảng NHANVIEN */
INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV) VALUES ('1006', 'Chi', '12/6 Nguyen Kiem', '8120012', 150000.00, 0)
INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV) VALUES ('1005', 'Giao', '65 Nguyen Thai Son', '8324467', 500000.00, 0)
INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV) VALUES ('1001', 'Huong', '8 Dien Bien Phu', '8330733', 500000.00, 1)
INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV) VALUES ('1002', 'Phong', '1 Ly Thuong Kiet', '8308117', 450000.00, 1)
INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV) VALUES ('1004', 'Phuong', '351 Lac Long Quan', '8308155', 250000.00, 0)
INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV) VALUES ('1003', 'Quang', '78 Truong Dinh', '8324461', 350000.00, 1)
INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV) VALUES ('1007', 'Tam', '36 Nguyen Van Cu', '8458188', 500000.00, 0)

/* Insert dữ liệu vào bảng KHACHHANG */
INSERT KHACHHANG (MAKH, TEN, DCHI, DTHOAI) VALUES ('0009', 'Nga', '223 Nguyen Trai', '8932320')
INSERT KHACHHANG (MAKH, TEN, DCHI, DTHOAI) VALUES ('0101', 'Anh', '567 Tran Phu', '8826729')
INSERT KHACHHANG (MAKH, TEN, DCHI, DTHOAI) VALUES ('0045', 'Thu', '285 Le Loi', '8932203')
INSERT KHACHHANG (MAKH, TEN, DCHI, DTHOAI) VALUES ('0012', 'Ha', '435 Quang Trung', '8933232')
INSERT KHACHHANG (MAKH, TEN, DCHI, DTHOAI) VALUES ('0238', 'Hung', '456 Pasteur', '9812101')
INSERT KHACHHANG (MAKH, TEN, DCHI, DTHOAI) VALUES ('0397', 'Thanh', '234 Le Van Si', '8952943')
INSERT KHACHHANG (MAKH, TEN, DCHI, DTHOAI) VALUES ('0582', 'Mai', '789 Nguyen Du', NULL)
INSERT KHACHHANG (MAKH, TEN, DCHI, DTHOAI) VALUES ('0934', 'Minh', '678 Le Lai', NULL)
INSERT KHACHHANG (MAKH, TEN, DCHI, DTHOAI) VALUES ('0091', 'Hai', '345 Hung Vuong', '8893223')
INSERT KHACHHANG (MAKH, TEN, DCHI, DTHOAI) VALUES ('0314', 'Phuong', '395 Vo Van Tan', '8232320')
INSERT KHACHHANG (MAKH, TEN, DCHI, DTHOAI) VALUES ('0613', 'Vu', '348 CMT8', '8343232')
INSERT KHACHHANG (MAKH, TEN, DCHI, DTHOAI) VALUES ('0586', 'Son', '123 Bach Dang', '8556223')
INSERT KHACHHANG (MAKH, TEN, DCHI, DTHOAI) VALUES ('0442', 'Tien', '75 Nguyen Thong', '8332222')

/* Insert dữ liệu vào bảng LOAIMB */
INSERT LOAIMB (HANGSX, MALOAI) VALUES ('Airbus', 'A310')
INSERT LOAIMB (HANGSX, MALOAI) VALUES ('Airbus', 'A320')
INSERT LOAIMB (HANGSX, MALOAI) VALUES ('Airbus', 'A330')
INSERT LOAIMB (HANGSX, MALOAI) VALUES ('Airbus', 'A340')
INSERT LOAIMB (HANGSX, MALOAI) VALUES ('Boeing', 'B727')
INSERT LOAIMB (HANGSX, MALOAI) VALUES ('Boeing', 'B747')
INSERT LOAIMB (HANGSX, MALOAI) VALUES ('Boeing', 'B757')
INSERT LOAIMB (HANGSX, MALOAI) VALUES ('MD', 'DC10')
INSERT LOAIMB (HANGSX, MALOAI) VALUES ('MD', 'DC9')

/* Insert dữ liệu vào bảng MAYBAY */
INSERT MAYBAY (SOHIEU, MALOAI) VALUES (10, 'B747')
INSERT MAYBAY (SOHIEU, MALOAI) VALUES (11, 'B727')
INSERT MAYBAY (SOHIEU, MALOAI) VALUES (13, 'B727')
INSERT MAYBAY (SOHIEU, MALOAI) VALUES (13, 'B747')
INSERT MAYBAY (SOHIEU, MALOAI) VALUES (21, 'DC10')
INSERT MAYBAY (SOHIEU, MALOAI) VALUES (21, 'DC9')
INSERT MAYBAY (SOHIEU, MALOAI) VALUES (22, 'B757')
INSERT MAYBAY (SOHIEU, MALOAI) VALUES (22, 'DC9')
INSERT MAYBAY (SOHIEU, MALOAI) VALUES (23, 'DC9')
INSERT MAYBAY (SOHIEU, MALOAI) VALUES (24, 'DC9')
INSERT MAYBAY (SOHIEU, MALOAI) VALUES (70, 'A310')
INSERT MAYBAY (SOHIEU, MALOAI) VALUES (80, 'A310')
INSERT MAYBAY (SOHIEU, MALOAI) VALUES (93, 'B757')

/* Insert dữ liệu vào bảng KHANANG */
INSERT KHANANG (MANV, MALOAI) VALUES ('1001', 'B727')
INSERT KHANANG (MANV, MALOAI) VALUES ('1001', 'B747')
INSERT KHANANG (MANV, MALOAI) VALUES ('1001', 'DC10')
INSERT KHANANG (MANV, MALOAI) VALUES ('1001', 'DC9')
INSERT KHANANG (MANV, MALOAI) VALUES ('1002', 'A320')
INSERT KHANANG (MANV, MALOAI) VALUES ('1002', 'A340')
INSERT KHANANG (MANV, MALOAI) VALUES ('1002', 'B757')
INSERT KHANANG (MANV, MALOAI) VALUES ('1002', 'DC9')
INSERT KHANANG (MANV, MALOAI) VALUES ('1003', 'A310')
INSERT KHANANG (MANV, MALOAI) VALUES ('1003', 'DC9')

/* Insert dữ liệu vào bảng LICHBAY */
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('11/01/2000', '100', 80, 'A310')
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('11/01/2000', '112', 21, 'DC10')
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('11/01/2000', '206', 22, 'DC9')
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('11/01/2000', '334', 10, 'B747')
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('11/01/2000', '395', 23, 'DC9')
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('11/01/2000', '991', 22, 'B757')
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('11/01/2000', '337', 10, 'B747')
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('10/31/2000', '100', 11, 'B727')
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('10/31/2000', '112', 11, 'B727')
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('10/31/2000', '206', 13, 'B727')
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('10/31/2000', '334', 10, 'B747')
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('10/31/2000', '335', 10, 'B747')
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('10/31/2000', '337', 24, 'DC9')
INSERT LICHBAY (NGAYDI, MACB, SOHIEU, MALOAI) VALUES ('10/31/2000', '449', 70, 'A310')

/* Insert dữ liệu vào bảng PHANCONG */
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1001', '11/01/2000', '100')
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1001', '10/31/2000', '100')
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1002', '11/01/2000', '100')
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1002', '10/31/2000', '100')
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1003', '10/31/2000', '100')
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1003', '10/31/2000', '337')
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1004', '10/31/2000', '100')
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1004', '10/31/2000', '337')
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1005', '10/31/2000', '337')
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1006', '11/01/2000', '991')
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1006', '10/31/2000', '337')
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1007', '11/01/2000', '112')
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1007', '11/01/2000', '991')
INSERT PHANCONG (MANV, NGAYDI, MACB) VALUES ('1007', '10/31/2000', '206')

/* Insert dữ liệu vào bảng DATCHO */
INSERT DATCHO (MAKH, NGAYDI, MACB) VALUES ('0009', '11/01/2000', '100')
INSERT DATCHO (MAKH, NGAYDI, MACB) VALUES ('0009', '10/31/2000', '449')
INSERT DATCHO (MAKH, NGAYDI, MACB) VALUES ('0045', '11/01/2000', '991')
INSERT DATCHO (MAKH, NGAYDI, MACB) VALUES ('0012', '10/31/2000', '206')
INSERT DATCHO (MAKH, NGAYDI, MACB) VALUES ('0238', '10/31/2000', '334')
INSERT DATCHO (MAKH, NGAYDI, MACB) VALUES ('0582', '11/01/2000', '991')
INSERT DATCHO (MAKH, NGAYDI, MACB) VALUES ('0091', '11/01/2000', '100')
INSERT DATCHO (MAKH, NGAYDI, MACB) VALUES ('0314', '10/31/2000', '449')
INSERT DATCHO (MAKH, NGAYDI, MACB) VALUES ('0613', '11/01/2000', '100')
INSERT DATCHO (MAKH, NGAYDI, MACB) VALUES ('0586', '11/01/2000', '991')
INSERT DATCHO (MAKH, NGAYDI, MACB) VALUES ('0586', '10/31/2000', '100')
INSERT DATCHO (MAKH, NGAYDI, MACB) VALUES ('0442', '10/31/2000', '449')